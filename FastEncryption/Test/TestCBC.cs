using FastEncryption.EncryptionAlgorithm;
using FastEncryption.OperationMode;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace FastEncryption.Test
{
    internal class TestCBC
    {
        public static void Run()
        {
            Console.WriteLine("********************************************");
            Console.WriteLine("************** CBC Test Start **************");
            Console.WriteLine("********************************************\n\n");

            TestAES_CBC();
            TestARIA_CBC();
            TestHIGHT_CBC();
            TestTWINE_CBC();
            TestSPECK_CBC();

            Console.WriteLine("********************************************");
            Console.WriteLine("*************** CBC Test End ***************");
            Console.WriteLine("********************************************\n\n");
        }

        private static void TestAES_CBC()
        {
            byte[] key = {
                0x12, 0x34, 0x56, 0x78,
                0x9A, 0xBC, 0xDE, 0xF0,
                0x11, 0x22, 0x33, 0x44,
                0x55, 0x66, 0x77, 0x88
            };

            // 45 bytes
            byte[] plainText = {
                0x41, 0x6E, 0x79, 0x20, 0x70, 0x6C, 0x61, 0x69,
                0x6E, 0x20, 0x74, 0x65, 0x78, 0x74, 0x20, 0x64,
                0x61, 0x74, 0x61, 0x20, 0x63, 0x61, 0x6E, 0x20,
                0x62, 0x65, 0x20, 0x75, 0x73, 0x65, 0x64, 0x20,
                0x66, 0x6F, 0x72, 0x20, 0x65, 0x78, 0x61, 0x6D,
                0x70, 0x6C, 0x65, 0x73, 0x2E
            };

            AES aes = new(key);
            CBC cbc = new(aes);

            TestMode test = new(cbc, key, plainText);
            test.Run();
        }

        private static void TestARIA_CBC()
        {
            byte[] key = {
                0x89, 0xAB, 0xCD, 0xEF,
                0x01, 0x23, 0x45, 0x67,
                0x89, 0xAB, 0xCD, 0xEF,
                0x01, 0x23, 0x45, 0x67
            };

            // 45bytes
            byte[] plainText = {
                0x54, 0x68, 0x69, 0x73, 0x20, 0x69, 0x73, 0x20,
                0x61, 0x6E, 0x6F, 0x74, 0x68, 0x65, 0x72, 0x20,
                0x65, 0x78, 0x61, 0x6D, 0x70, 0x6C, 0x65, 0x20,
                0x6F, 0x66, 0x20, 0x61, 0x20, 0x66, 0x6F, 0x72,
                0x74, 0x79, 0x2D, 0x66, 0x69, 0x76, 0x65, 0x20,
                0x62, 0x79, 0x74, 0x65, 0x73
            };

            ARIA aria = new(key);
            CBC cbc = new(aria);

            TestMode test = new(cbc, key, plainText);
            test.Run();
        }

        private static void TestHIGHT_CBC()
        {
            byte[] key = {
                0xAA, 0xBB, 0xCC, 0xDD,
                0xEE, 0xFF, 0x00, 0x11,
                0x22, 0x33, 0x44, 0x55,
                0x66, 0x77, 0x88, 0x99
            };

            // 45bytes
            byte[] plainText = {
                0x4C, 0x6F, 0x72, 0x65, 0x6D, 0x20, 0x69, 0x70,
                0x73, 0x75, 0x6D, 0x20, 0x64, 0x6F, 0x6C, 0x6F,
                0x72, 0x20, 0x73, 0x69, 0x74, 0x20, 0x61, 0x6D,
                0x65, 0x74, 0x2C, 0x20, 0x63, 0x6F, 0x6E, 0x73,
                0x63, 0x74, 0x65, 0x74, 0x75, 0x72, 0x20, 0x61,
                0x67, 0x20, 0x65, 0x6C, 0x69
            };

            HIGHT hight = new(key);
            CBC cbc = new(hight);

            TestMode test = new(cbc, key, plainText);
            test.Run();
        }

        private static void TestSPECK_CBC()
        {
            byte[] key = {
                0x01, 0x23, 0x45, 0x67,
                0x89, 0xAB, 0xCD, 0xEF,
                0x10, 0x32, 0x54, 0x76,
                0x98, 0xBA, 0xDC, 0xFE
            };

            // 45bytes
            byte[] plainText = {
                0x54, 0x68, 0x65, 0x20, 0x71, 0x75, 0x69, 0x63,
                0x6B, 0x20, 0x62, 0x72, 0x6F, 0x77, 0x6E, 0x20,
                0x66, 0x6F, 0x78, 0x20, 0x6A, 0x75, 0x6D, 0x70,
                0x73, 0x20, 0x6F, 0x76, 0x65, 0x72, 0x20, 0x74,
                0x68, 0x65, 0x20, 0x6C, 0x61, 0x7A, 0x79, 0x20,
                0x64, 0x6F, 0x67, 0x2E, 0xF2
            };

            SPECK speck = new(key);
            CBC cbc = new(speck);

            TestMode test = new(cbc, key, plainText);
            test.Run();
        }

        private static void TestTWINE_CBC()
        {
            byte[] key = {
                0x0F, 0x1E, 0x2D, 0x3C,
                0x4B, 0x5A, 0x69, 0x78,
                0x87, 0x96, 0xA5, 0xB4,
                0xC3, 0xD2, 0xE1, 0xF0
            };

            // 45bytes
            byte[] plainText = {
                0x54, 0x68, 0x69, 0x73, 0x20, 0x69, 0x73, 0x20,
                0x79, 0x65, 0x74, 0x20, 0x61, 0x6E, 0x6F, 0x74,
                0x68, 0x65, 0x72, 0x20, 0x65, 0x78, 0x61, 0x6D,
                0x70, 0x6C, 0x65, 0x20, 0x66, 0x6F, 0x72, 0x20,
                0x74, 0x68, 0x65, 0x20, 0x61, 0x6C, 0x67, 0x6F,
                0x72, 0x69, 0x74, 0x68, 0x6D
            };

            TWINE twine = new(key);
            CBC cbc = new(twine);

            TestMode test = new(cbc, key, plainText);
            test.Run();
        }
    }
}
